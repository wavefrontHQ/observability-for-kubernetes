# Helm Charts for Aria Operator

**NOTE:** These charts are not for use outside of Aria Hub. They will not work for standalone Wavefront/OpApps customers.

## Aria Operator Chart
Generated by release scripts.

## Installing

**Helm 3.8+**

Helm 3.8 adopted a different distribution model for Charts. OCI image registries are the preferred method of
distributing Charts going forward.

**Namespace:** the only currently supported namespace for deploying these charts is `observability-system`.

```
helm install aria-integration --create-namespace --namespace observability-system \
  oci://projects.registry.vmware.com/tanzu_observability/helm-charts/aria-integration

helm install aria-configuration --namespace observability-system \
  oci://projects.registry.vmware.com/tanzu_observability/helm-charts/aria-configuration \
  --set clusterName=<CLUSTER_NAME> \
  --set k8sEvents.url=<URL> \
  --set k8sEvents.token=<LEMANS_TOKEN>
```

## Uninstalling
Run the following commands in this order.

```
helm uninstall aria-configuration --namespace observability-system

helm uninstall aria-integration --namespace observability-system

kubectl delete namespace observability-system
```

If you ran the commands in the wrong order, you may see this error `Error: failed to delete release: aria-configuration`. 

If you do, you can delete the `observability-system` namespace to clean up:

```
kubectl delete namespace observability-system
```

## Developing

To package, push, and install a helm chart to Harbor Dev:
```
helm package ./aria-integration
helm push aria-integration-*.tgz oci://projects.registry.vmware.com/tanzu_observability_keights_saas/helm-charts

helm package ./aria-configuration
helm push aria-configuration-*.tgz oci://projects.registry.vmware.com/tanzu_observability_keights_saas/helm-charts

# Install the charts auto-published in CI for the `main` branch
helm install aria-integration --create-namespace --namespace observability-system \
  oci://projects.registry.vmware.com/tanzu_observability_keights_saas/helm-charts/aria-integration --version 0.1.1-main

helm install aria-configuration --namespace observability-system \
  oci://projects.registry.vmware.com/tanzu_observability_keights_saas/helm-charts/aria-configuration --version 0.1.1 \
  --set clusterName=<CLUSTER_NAME> \
  --set k8sEvents.url=<URL> \
  --set k8sEvents.token=<LEMANS_TOKEN>
```

To package and push a helm chart to Harbor Prod:
```
helm package ./aria-integration
helm push aria-integration-*.tgz oci://projects.registry.vmware.com/tanzu_observability/helm-charts

helm package ./aria-configuration
helm push aria-configuration-*.tgz oci://projects.registry.vmware.com/tanzu_observability/helm-charts
```

